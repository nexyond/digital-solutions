const dictionary = {
    tr: {
        nav_vision: "VİZYON", nav_services: "HİZMETLER", nav_process: "SÜREÇ", nav_contact: "İLETİŞİM", nav_cta: "Hemen Başla",
        hero_status: "SİSTEMLER AKTİF", hero_title_1: "İşinizi Dijitalin", hero_title_2: "Zirvesine Taşıyın.",
        hero_desc: "Web sitesi, mobil uygulama veya dijital kartvizit... Rakiplerinizin önüne geçmek için ihtiyacınız olan her şeyi tasarlıyor ve kodluyoruz.",
        cta_main: "Teklif Alın", cta_sec: "Hizmetlerimiz", cta_mailto: "Hemen Başlayın (Teklif Alın)",
        vision_title: "Geleneksel Kalma,<br><span class='text-gradient-blue'>Geleceğe Odaklan.</span>",
        vision_desc_1: "Eski usül ticaret yöntemleri yavaş yavaş kayboluyor. Müşterileriniz artık sizi telefonda, Google'da veya sosyal medyada arıyor. Fiziksel ofis sınırlarını kaldırarak, AI gücüyle işlerinizi ışık hızında dijitale taşıyoruz.", vision_desc_2: "Eğer internette yoksanız, müşterileriniz için de yoksunuz demektir. Nexyond olarak sizi dijital dünyada görünür, ulaşılabilir ve prestijli kılıyoruz.",
        vision_point_1: "7/24 Açık Dükkan (Web Sitesi)", vision_point_2: "Milyonlara Ulaşan Reklamlar", vision_point_3: "Kağıt Masrafsız Dijital Çözümler",
        vision_card_title: "Dijital Dönüşüm", vision_card_desc: "Fiziksel sınırları kaldırın. Dünyanın her yerinden müşteri edinin.",
        services_title: "Neler Yapıyoruz?", services_subtitle: "İşletmenizin ihtiyacı olan tüm dijital araçlar tek çatı altında.",
        svc_web_title: "Web Sitesi Tasarımı & Kurulumu", svc_web_desc: "Müşterileriniz sizi Google'da aradığında profesyonel bir vitrinle karşılaşsın. Kurumsal siteler, bloglar veya ürün tanıtım sayfaları. Hızlı, şık ve tüm telefonlara uyumlu.",
        svc_qr_title: "Dijital Kartvizit (NFC & QR)", svc_qr_desc: "Temassız NFC teknolojisi ve QR kod ile bilgilerinizi saniyeler içinde paylaşın. Kağıt israfına son verin.",
        tag_popular: "ÇOK POPÜLER", svc_app_title: "Mobil Uygulama (App)", svc_app_desc: "Fikrinizi cebinize sığdırıyoruz. iOS (iPhone) ve Android için size özel, hızlı çalışan uygulamalar yapıyoruz.",
        svc_logo_title: "Logo & Marka Kimliği", svc_logo_desc: "Akılda kalıcı bir logo ve kurumsal renkler tasarlıyoruz. Müşterileriniz sizi ilk görüşte tanısın.",
        svc_content_title: "AI İçerik & Sosyal Medya", svc_content_desc: "Yapay zeka ile profesyonel fotoğraflar, Instagram gönderileri ve marka içerikleri oluşturuyoruz. Sosyal medya hesaplarınızı canlandırıyoruz.",
        svc_auto_title: "E-Ticaret & İş Otomasyonu", svc_auto_desc: "İnternetten ürün satın veya işlerinizi robotlara bırakın. Stok takibi, müşteri kaydı, otomatik WhatsApp mesajları gibi sıkıcı işleri yazılımlarımız yapsın.",
        svc_gumroad_title: "Hazır Dijital Ürünler", svc_gumroad_desc: "E-Kitaplar, hazır fotoğraf setleri, sosyal medya şablonları gibi işinize hemen yarayacak yüzlerce ürüne ulaşın.", svc_gumroad_cta: "Tüm Ürünleri İncele →",
        process_title: "Nasıl Çalışıyoruz?",
        step_1_title: "Tanışma & Fikir", step_1_desc: "Sizi dinliyoruz. Neye ihtiyacınız olduğunu (Site mi? Kartvizit mi?) belirliyoruz.",
        step_2_title: "Tasarım & Yapım", step_2_desc: "Sizin onayınıza göre tasarımı hazırlıyor ve kodlamasını yapıyoruz.",
        step_3_title: "Teslim & Destek", step_3_desc: "İşinizi teslim ediyoruz ve kullanımını öğretiyoruz. Takıldığınız yerde destek oluyoruz.",
        footer_tagline: "İşinizi büyütmek için gereken tüm dijital çözümler burada.", footer_links_title: "Hızlı Bağlantılar", footer_link_services: "Hizmetlerimiz", footer_link_process: "Çalışma Sürecimiz", footer_link_contact: "İletişim",
        assist_header: "Nexyond Dijital Asistan", assist_initial: "Merhaba! Size nasıl yardımcı olabilirim? Lütfen bir konu seçin:",
        assist_opt_web: "Web Sitesi", assist_opt_card: "Dijital Kartvizit", assist_opt_app: "Mobil Uygulama", assist_opt_logo: "Logo Tasarım", assist_opt_content: "AI İçerik", assist_opt_price: "Fiyatlar & Süre", assist_opt_contact: "İletişime Geç",
        assist_res_web: "Web sitesi bir dükkanınızın internetteki şubesidir. Müşterileriniz 7/24 ürünlerinizi, hizmetlerinizi ve hakkınızdaki bilgileri görebilir. Size özel, güncel teknolojiyle, tüm cihazlara uyumlu (telefon/tablet) siteler hazırlıyoruz. En önemlisi, sitenizi Google'da üst sıralara çıkacak şekilde kuruyoruz.",
        assist_res_kartvizit: "Dijital Kartvizit, QR kod teknolojisi ile anında çalışan modern bir çözümdür. Müşteri QR kodu okuttuğunda, iletişim bilgileriniz, sosyal medya linkleriniz ve web siteniz tek bir sayfada görünür. Hem çevre dostu hem de çok daha prestijli. Kağıt israfını tamamen ortadan kaldırır.",
        assist_res_app: "Mobil uygulama geliştirme hizmetimizle fikirlerinizi iOS ve Android platformlarına taşıyoruz. Kullanıcı dostu arayüzler, yüksek performans ve güvenlik önceliğiyle profesyonel uygulamalar geliştiriyoruz.",
        assist_res_logo: "Logo ve marka kimliği tasarımıyla işletmenizin görsel kimliğini güçlendiriyoruz. Modern, akılda kalıcı ve sektörünüze uygun logo tasarımları oluşturuyoruz.",
        assist_res_content: "Yapay zeka destekli içerik üretimi ve sosyal medya yönetimi hizmeti sunuyoruz. Profesyonel fotoğraflar, Instagram gönderileri ve marka içerikleri oluşturuyoruz.",
        assist_res_fiyat: "Fiyatlandırma, projenin büyüklüğüne ve istediğiniz özelliklere göre değişir. Web sitesi projeleri genellikle 1-3 hafta sürer. En doğru fiyat ve süre için teklif almanızı öneririz.",
        assist_res_contact: "Bize ulaşmak çok kolay! nexyond@gmail.com adresinden mail atabilir veya teklif isteği iletebilirsiniz.",
        stat_customers: "Müşteri Artışı", stat_response: "Saat Tepki", stat_projects: "Proje Teslim", stat_satisfaction: "Memnuniyet",
        work_title: "Vizyoner Projeler", work_subtitle: "Nexyond Lab'da hazırlanan dijital konsept çalışmalarımız."
    },
    en: {
        stat_customers: "Customer Growth", stat_response: "Hour Response", stat_projects: "Projects Delivered", stat_satisfaction: "Satisfaction",
        nav_vision: "VISION", nav_services: "SERVICES", nav_process: "PROCESS", nav_contact: "CONTACT", nav_cta: "Get Started",
        hero_status: "SYSTEMS ONLINE", hero_title_1: "Forge Your", hero_title_2: "Digital Destiny.",
        hero_desc: "Websites, mobile apps, or digital business cards... We design and code everything you need to stay ahead of the competition.",
        cta_main: "Get a Quote", cta_sec: "Our Services", cta_mailto: "Get Started (Request Quote)",
        vision_title: "Adapt or Fade,<br><span class='text-gradient-blue'>Evolve Now.</span>",
        vision_desc_1: "Traditional business methods are fading. Your customers look for you online. We move your business to digital at light speed using AI power.", vision_desc_2: "If you aren't online, you don't exist. Nexyond makes you visible, accessible, and prestigious.",
        vision_point_1: "24/7 Open Store (Website)", vision_point_2: "Reach Millions with Ads", vision_point_3: "Paperless Digital Solutions",
        vision_card_title: "Digital Shift", vision_card_desc: "Remove physical limits. Acquire customers globally.",
        services_title: "What We Do", services_subtitle: "All the digital tools your business needs under one roof.",
        svc_web_title: "Web Design & Development", svc_web_desc: "High-performance, SEO-optimized, and modern web experiences that look flawless on every device.",
        svc_app_title: "Mobile App Solutions", svc_app_desc: "Turning ideas into portable technology. High-speed, UX-focused apps for iOS and Android.",
        svc_auto_title: "E-Commerce & Automation", svc_auto_desc: "Automate your sales and operations. Smart systems that grow your business even while you sleep.",
        svc_qr_title: "Digital Business Card (NFC & QR)", svc_qr_desc: "Modernize your networking. Share your info with a single tap; save costs and maintain prestige.",
        svc_logo_title: "Brand Identity & Logo Design", svc_logo_desc: "Give your brand a soul. We create corporate palettes and visual identities that connect.",
        svc_content_title: "AI-Powered Content & Strategy", svc_content_desc: "Stand out on social media with the power of AI. We make your brand visible through data-driven content.",
        svc_gumroad_title: "Ready-Made Digital Products", svc_gumroad_desc: "Access hundreds of digital products you can use immediately for your business.", svc_gumroad_cta: "View All Products →",
        process_title: "How We Work",
        step_1_title: "Meet & Plan", step_1_desc: "We listen to you. We determine exactly what you need.",
        step_2_title: "Design & Build", step_2_desc: "We prepare the design and code it based on your approval.",
        step_3_title: "Launch & Support", step_3_desc: "We deliver the project and provide support whenever you need it.",
        footer_tagline: "All digital solutions to grow your business are here.", footer_links_title: "Quick Links", footer_link_services: "Our Services", footer_link_process: "Our Process", footer_link_contact: "Contact",
        assist_header: "Nexyond Digital Assistant", assist_initial: "Hello! How may I help you? Please select a topic:",
        assist_opt_web: "Website", assist_opt_card: "Digital Business Card", assist_opt_app: "Mobile App", assist_opt_logo: "Logo Design", assist_opt_content: "AI Content", assist_opt_price: "Pricing & Duration", assist_opt_contact: "Get in Touch",
        assist_res_web: "A website is the internet branch of your store. We prepare custom, up-to-date, device-compatible sites that rank high on Google.",
        assist_res_kartvizit: "Digital Business Card works instantly with QR technology. Eco-friendly and prestigious. No more paper waste.",
        assist_res_app: "We develop professional apps for iOS and Android with high performance and security priority.",
        assist_res_logo: "We create modern, memorable logo designs and brand identities that increase your brand value.",
        assist_res_content: "We offer AI-powered content and social media management to revitalize your brand's digital presence.",
        assist_res_fiyat: "Pricing varies by project size. Websites take 1-3 weeks. Contact us for a detailed quote.",
        assist_res_contact: "Reach us at nexyond@gmail.com or use the 'Get Started' buttons for a quote.",
        work_title: "Visionary Projects", work_subtitle: "Concept works prepared in Nexyond lab, setting digital trends."
    }
};

let currentLang = 'tr';
let projectsData = [];
let currentProjectSlide = 0;
let projectInterval;

async function loadProjects() {
    try {
        const response = await fetch('data/projects.json');
        const data = await response.json();
        projectsData = data.projects;
        renderProjects();
        showSlide(0);
    } catch (error) {
        console.error("Projeler yuklenemedi:", error);
    }
}

function renderProjects() {
    const container = document.getElementById('project-container');
    const dotsContainer = document.getElementById('project-dots');
    if (!container || !dotsContainer) return;
    
    container.innerHTML = '';
    dotsContainer.innerHTML = '';

    projectsData.forEach((project, index) => {
        const slide = document.createElement('div');
        slide.className = `project-slide absolute inset-0 transition-all duration-700 opacity-0 scale-95 pointer-events-none`;
        slide.innerHTML = `
            <div class="relative h-full w-full rounded-3xl overflow-hidden border border-white/5">
                <img src="${project.img_url}" class="w-full h-full object-cover" alt="Project">
                <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent flex flex-col justify-end p-8 md:p-12">
                    <h3 class="text-2xl md:text-4xl font-bold mb-3">${currentLang === 'tr' ? project.name_tr : project.name_en}</h3>
                    <p class="text-gray-300 max-w-xl text-sm md:text-base">${currentLang === 'tr' ? project.desc_tr : project.desc_en}</p>
                </div>
            </div>
        `;
        container.appendChild(slide);

        const dot = document.createElement('button');
        dot.className = `project-dot w-2 h-2 rounded-full bg-white/20 transition-all duration-300`;
        dot.onclick = () => showSlide(index);
        dotsContainer.appendChild(dot);
    });
}

function setLanguage(lang) {
    currentLang = lang;
    const data = dictionary[lang];
    if (!data) return;

    document.getElementById('lang-tr').classList.remove('font-bold', 'text-white');
    document.getElementById('lang-en').classList.remove('font-bold', 'text-white');
    document.getElementById('lang-' + lang).classList.add('font-bold', 'text-white');
    
    document.querySelectorAll('[data-lang]').forEach(el => {
        const key = el.getAttribute('data-lang');
        if (data[key]) {
            if (key === 'vision_title' || key === 'hero_title_2') el.innerHTML = data[key];
            else el.textContent = data[key];
        }
    });
    renderProjects();
    resetAssistant();
}

function showSlide(index) {
    const slides = document.querySelectorAll('.project-slide');
    const dots = document.querySelectorAll('.project-dot');
    if (!slides.length) return;

    slides.forEach((s, i) => {
        s.classList.add('opacity-0', 'scale-95', 'pointer-events-none');
        s.classList.remove('opacity-100', 'scale-100');
        dots[i].classList.remove('bg-blue-500', 'w-6');
        dots[i].classList.add('bg-white/20');
        dots[i].style.width = "8px";
    });

    currentProjectSlide = (index + slides.length) % slides.length;
    slides[currentProjectSlide].classList.replace('opacity-0', 'opacity-100');
    slides[currentProjectSlide].classList.replace('scale-95', 'scale-100');
    slides[currentProjectSlide].classList.remove('pointer-events-none');
    
    dots[currentProjectSlide].classList.replace('bg-white/20', 'bg-blue-500');
    dots[currentProjectSlide].style.width = "24px";
    resetProjectInterval();
}

function nextProject() { showSlide(currentProjectSlide + 1); }
function prevProject() { showSlide(currentProjectSlide - 1); }
function resetProjectInterval() {
    if (projectInterval) clearInterval(projectInterval);
    projectInterval = setInterval(nextProject, 8000);
}

function toggleMenu() { document.getElementById('mobile-menu').classList.toggle('translate-x-full'); }

window.addEventListener('scroll', () => {
    const nav = document.getElementById('navbar');
    if (window.scrollY > 50) nav.classList.add('glass');
    else nav.classList.remove('glass');
});

const assistantModal = document.getElementById('assistant-modal');
const chatWindow = document.getElementById('chat-window');

function toggleAssistant() {
    assistantModal.classList.toggle('open');
    if(assistantModal.classList.contains('open')) resetAssistant();
}

function resetAssistant() {
    const msg = dictionary[currentLang]['assist_initial'];
    chatWindow.innerHTML = `<div class="chat-message message-bot">${msg}</div>`;
}

function handleOptionClick(optionKey) {
    const userText = dictionary[currentLang]['assist_opt_' + optionKey];
    const respText = dictionary[currentLang]['assist_res_' + optionKey];
    
    const uMsg = document.createElement('div');
    uMsg.className = 'chat-message message-user ml-auto max-w-[85%]';
    uMsg.textContent = userText;
    chatWindow.appendChild(uMsg);

    const bMsg = document.createElement('div');
    bMsg.className = 'chat-message message-bot mr-auto max-w-[85%]';
    bMsg.innerHTML = optionKey === 'contact' ? `${respText} <br><br> <a href="mailto:nexyond@gmail.com" class="text-blue-400 underline">nexyond@gmail.com</a>` : respText;
    chatWindow.appendChild(bMsg);
    chatWindow.scrollTop = chatWindow.scrollHeight;
}

function animateCounters() {
    const counters = [{id:'count1',t:87},{id:'count2',t:24},{id:'count3',t:150},{id:'count4',t:98}];
    counters.forEach(c => {
        let curr = 0;
        const el = document.getElementById(c.id);
        const itv = setInterval(() => {
            curr += c.t/50;
            if(curr >= c.t) { el.textContent = c.t + '+'; clearInterval(itv); }
            else el.textContent = Math.floor(curr);
        }, 40);
    });
}

const canvas = document.getElementById('bg-canvas');
const ctx = canvas.getContext('2d');
let width, height, particles = [];

function resize() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
}

class Particle {
    constructor() {
        this.x = Math.random() * width;
        this.y = Math.random() * height;
        this.vx = (Math.random() - 0.5) * 0.5;
        this.vy = (Math.random() - 0.5) * 0.5;
        this.size = Math.random() * 2;
    }
    update() {
        this.x += this.vx; this.y += this.vy;
        if (this.x < 0 || this.x > width) this.vx *= -1;
        if (this.y < 0 || this.y > height) this.vy *= -1;
    }
    draw() {
        ctx.fillStyle = 'rgba(100, 116, 139, 0.3)';
        ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
    }
}

function initParticles() {
    particles = [];
    for (let i = 0; i < Math.min(window.innerWidth / 10, 100); i++) particles.push(new Particle());
}

function animate() {
    ctx.clearRect(0, 0, width, height);
    particles.forEach((p, idx) => {
        p.update(); p.draw();
        for (let j = idx + 1; j < particles.length; j++) {
            const p2 = particles[j];
            const d = Math.sqrt((p.x-p2.x)**2 + (p.y-p2.y)**2);
            if (d < 150) {
                ctx.strokeStyle = `rgba(59, 130, 246, ${0.1 - d/1500})`;
                ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
            }
        }
    });
    requestAnimationFrame(animate);
}

window.addEventListener('resize', () => { resize(); initParticles(); });

document.addEventListener('DOMContentLoaded', () => {
    setLanguage(currentLang);
    loadProjects();
    animateCounters();
    resize(); initParticles(); animate();
});
